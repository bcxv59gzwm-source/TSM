# =====================================
# Install BitLocker - Windows Server 2016
# =====================================

Write-Host "=== Installing BitLocker Feature ===" -ForegroundColor Cyan

# --- Admin Check ---
if (-not ([Security.Principal.WindowsPrincipal]
    [Security.Principal.WindowsIdentity]::GetCurrent()
).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {

    Write-Host "ERROR: Run this script as Administrator." -ForegroundColor Red
    exit 1
}

# --- Check BitLocker Feature ---
$feature = Get-WindowsFeature -Name BitLocker

if ($feature.Installed) {
    Write-Host "BitLocker is already installed." -ForegroundColor Green
}
else {
    Write-Host "Installing BitLocker feature..." -ForegroundColor Yellow

    Install-WindowsFeature `
        -Name BitLocker `
        -IncludeAllSubFeature `
        -IncludeManagementTools `
        -Restart:$false

    Write-Host "BitLocker feature installation complete." -ForegroundColor Green
}

# --- Verify ---
Get-WindowsFeature -Name BitLocker | Select Name, Installed
